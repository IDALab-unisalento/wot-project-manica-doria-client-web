<div class="padding-md">
  <div class="card shadow dimension">

    <div class="card-header">
      <h3>Maintenance</h3>
    </div>

    <div class="card-body">
      <div class="row">
        <div class="col-5">

          <div class="input-group">
            <select class="custom-select border-right-0" style="border-radius: 10px 0 0 10px;"
              id="inputGroupSelectMaintenance" (change)="getAllStepByMaintenance(); getAllZoneByMachine()">
              <option value="0" selected>Choose a Maintenance...</option>
              <option *ngFor="let maintenance of maintenanceList" value="{{maintenance.id}}">{{maintenance.name}}
                ({{maintenance.type}})</option>
            </select>

            <a class="btn border-top border-bottom" style="border-radius: 0; border: #cfd4d9"
              (click)="formMaintenance()">
              <i class="fa fa-plus-square-o fa-lg"></i>
            </a>
            <a class="btn border border-left-0" style="border-radius: 0 10px 10px 0; border: #cfd4d9"
              (click)="deleteMaintenance()">
              <i class="fa fa-trash fa-lg text-danger"></i>
            </a>
          </div>

          <form class="padding-top-sm" *ngIf="isCreate">
            <div class="form-group">
              <input placeholder="Maintenance name" type="text" class="form-control" #name name="name">
            </div>

            <select place class="custom-select" id="inputGroupSelect04">
              <option value="0" selected>Choose a Type..</option>
              <option value="Ordinary">Ordinary</option>
              <option value="Extraordinary">Extraordinary</option>
            </select>

            <div class="form-group pdt10">
              <textarea placeholder="Description" class="form-control" id="textAreaDescriptionMaintenance"
                rows="3"></textarea>
            </div>


            <div class="input-group">
              <select class="custom-select" id="inputGroupSelect01">
                <option value="0" selected>Choose a Machine...</option>
                <option *ngFor="let machine of machineList" value="{{machine.id}}">{{machine.name}}
                  ({{machine.serialNumber}})
                </option>
              </select>
            </div>

            <div class="d-flex justify-content-end padding-bottom-sm pdt10">
              <button type="submit" class="btn btn-success" (click)="saveMaintenance()">Save</button>
              <button type="submit" class="btn btn-danger" style=" margin-left: 10px;"
                (click)="annulla()">Cancel</button>
            </div>

          </form>

          <div *ngIf="!isCreate">

            <div class="input-group pdt10">
              <select class="custom-select" id="inputGroupSelect02" style="border-radius: 10px;">
                <option value="0" selected>Choose a Zone...</option>
                <option *ngFor="let zone of zoneList" value="{{zone.id}}">{{zone.name}} ({{zone.beacon.name}})
                </option>
              </select>
            </div>
            <small class="pdb10" style="color: #a0a0a0;">Select a maintenance area</small>

            <div class="form-group pdx10">
              <input placeholder="Name Step" type="text" class="form-control" #name name="name" maxlength="65">
            </div>

            <div class="form-group">
              <span style="margin-right: 10px">Estimated duration</span>
              <input placeholder="Estimated Duration" style="border: 1px solid #aeaeae; border-radius: 10px" type="time"
                id="appt" name="appt" min="09:00" max="18:00" required (change)="print()">
            </div>

            <div class="form-group">
              <textarea style="border-radius: 10px;" placeholder="Description" class="form-control border-radius"
                id="textAreaDescriptionStep" rows="3"></textarea>
            </div>

            <form>

              <div class="input-group">
                <div class="custom-file">
                  <input (change)="onFileSelected($event)" type="file" class="custom-file-input" id="inputImage"
                    accept="image/*" multiple="multiple">
                  <label class="custom-file-label" for="inputImage" aria-describedby="inputImage"
                    style="overflow: scroll;">{{fileName}}</label>
                </div>
              </div>


              <div class="form-group pdt10">
                <input placeholder="Add Video Url" style="border-radius: 10px;" type="text" class="form-control"
                  [(ngModel)]="video" name="video">
              </div>

            </form>
            <div class="d-flex justify-content-end">
              <button type="submit" class="btn btn-outline-secondary" (click)="getZoneById()">Aggiungi
                Step</button>
            </div>

          </div>
        </div>

        <div *ngIf="!isCreate">
          <div class="col" *ngIf=" stepList.length !==0;">
            <ul data-toggle="modal" data-target="#DetailsModal" type="button" class="pdb10 row"
              *ngFor="let step of stepList, let myindex = index">
              <div class="col-10 border-color" (click)="selectStepDetails(step)">
                <h6>{{step.name}}</h6>
                Zone:<span style=" margin-left: 20px">{{step.zone.name}}</span>
              </div>

              <div class="col-2 d-flex justify-content-end">
                <a class="btn bg-transparent fa-lg " style="color: #960000; " (click)="deleteStep(step.id, myindex)">
                  <i class="fa fa-trash fa-lg" aria-hidden="true"></i>
                </a>
              </div>
            </ul>
            <div class="d-flex justify-content-end">
              <button type="submit" class="btn btn-outline-secondary" (click)="saveStep()">Save Steps</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="DetailsModal">
  <div class="modal-dialog modal-dialog-centered modal-xl modal-custom">
    <div class="modal-content ">

      <!-- Modal Header -->
      <div class="modal-header bg-modal">
        <h4 class="modal-title">Step Details</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <div style="margin: 0 50px;" class="d-flex justify-content-center">
          <app-carousel [pics]="this.attachmentList"></app-carousel>
        </div>
      </div>



      <div class=" row border-color" style="margin: 20px">
        <div class="col-3">
          <b>Description:</b>
          <br>
          <b>Estimated Duration:</b>
          <br>
          <b>Work Zone:</b>
          <div style="margin-left: 20px">
            <b>Name:</b>
            <div>
              <b>Beacon:</b>
            </div>
          </div>
        </div>

        <div class="col-9">
          {{selectedStep.name}}
          <br>
          {{selectedStep.estimateDuration}}
          <br>
          <br>
          {{selectedStep.zone.name}}
          <br>
          {{selectedStep.zone.beacon.name}}
        </div>
      </div>


      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-danger" data-dismiss="modal">Close</button>
      </div>

    </div>
  </div>
</div>